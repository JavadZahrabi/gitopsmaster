= Evaluation and Case Study of the GitOps Principle

== Application Repository - Initial situation

.Local Version API endpoint
[source,http]
----
http://localhost:8083/api/v1/version
----

.Example JSON response
[source,json]
----
{
  "name":"gitops-evaluation-spring-boot-example",
  "environment":"PROD",
  "version":"1.0.0"
}
----

=== Quick Start

Open REST API specification: _http://localhost:8083/api/specification/index.html_

==== Start development server
[source,bash]
----
$ cd application
$ sh ./mvnw spring-boot:run
----

==== Build Docker Image
[source,bash]
----
$ cd application
$ sh ./mvnw spring-boot:build-image
----

Generated Docker Image name schema: `${docker.hub.organization}/${project.artifactId}`

Use `$ sh ./mvnw spring-boot:build-image -D docker.hub.organization=my-organization`
to change the Docker Hub Organization or username.

==== Run Docker Container
[source,bash]
----
$ docker run -p 8083:8083 --env APPLICATION_VERSION=1.0.0 --env APPLICATION_ENVIRONMENT=LOCAL alehnert/gitops-evaluation-spring-boot-example
----

.Available Environment Variables
[cols="2,2"]
|=======================================================================
|*Environment Variable*         |*Values*
.2+|APPLICATION_ENVIRONMENT     |LOCAL (default)
                                |PROD
|APPLICATION_VERSION            |<String, default: "unknown">
|=======================================================================


==== Run Docker Container with predefined environment file
[source,bash]
----
$ docker run -p 8083:8083 --env-file ../deployment/environment-variables/local.properties alehnert/gitops-evaluation-spring-boot-example
----


